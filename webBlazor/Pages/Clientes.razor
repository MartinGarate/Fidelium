@page "/clientes"
@inject IGenericService<Cliente> _serviceCliente
@inject IGenericService<Usuario> _serviceUsuario

<PageTitle>Clientes</PageTitle>

<div class="page-container">
    <div class="page-header">
        <h1>
            <i class="fas fa-users me-2"></i>
            Clientes
        </h1>
    </div>

    @if (clientes == null)
    {
        <div class="loading-state">
            <div class="spinner"></div>
            <p><em>Cargando los clientes...</em></p>
        </div>
    }
    else if (!clientes.Any())
    {
        <div class="empty-state">
            <i class="fas fa-users-slash mb-3"></i>
            <p><em>No hay clientes disponibles.</em></p>
        </div>
    }
    else
    {
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th>
                            <i class="fas fa-user me-2"></i>
                            Nombre
                        </th>
                        <th>
                            <i class="fas fa-envelope me-2"></i>
                            Email
                        </th>
                        <th>
                            <i class="fas fa-id-card me-2"></i>
                            DNI
                        </th>
                        <th>
                            <i class="fas fa-user-tag me-2"></i>
                            Tipo de Usuario
                        </th>
                        <th>
                            <i class="fab fa-instagram me-2"></i>
                            Instagram
                        </th>
                        <th>
                            <i class="fas fa-phone me-2"></i>
                            Teléfono
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var cli in clientes)
                    {
                        <tr>
                            <td>@cli?.Usuario?.Nombre</td>
                            <td>
                                <a href="mailto:@cli?.Usuario?.Email">@cli?.Usuario?.Email</a>
                            </td>
                            <td>@cli?.Usuario?.DNI</td>
                            <td>
                                <span class="badge">@cli?.Usuario?.TipoUsuario</span>
                            </td>
                            <td>
                                @if (!string.IsNullOrEmpty(cli?.Instagram))
                                {
                                    <a href="https://instagram.com/@cli.Instagram" target="_blank">
                                        @cli.Instagram
                                    </a>
                                }
                            </td>
                            <td>
                                @if (!string.IsNullOrEmpty(cli?.Telefono))
                                {
                                    <a href="tel:@cli.Telefono">@cli.Telefono</a>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>

@code {
    private List<Cliente>? clientes;
    private List<Usuario>? usuarios;

    protected override async Task OnInitializedAsync()
    {
        clientes = (await _serviceCliente.GetAllAsync(null))?.ToList();
        usuarios = (await _serviceUsuario.GetAllAsync(null))?.ToList();
    }
}
